"use strict";

Object.defineProperty(exports, "__esModule", {
  value: !0
});

var _defineProperty = require("@babel/runtime/helpers/defineProperty"), FieldController = require("@keystonejs/fields/Controller");

function _interopDefault(e) {
  return e && e.__esModule ? e : {
    default: e
  };
}

var _defineProperty__default = _interopDefault(_defineProperty), FieldController__default = _interopDefault(FieldController);

class MongoIdController extends FieldController__default.default {
  constructor(...args) {
    super(...args), _defineProperty__default.default(this, "getFilterGraphQL", ({type: type, value: value}) => {
      switch (type) {
       case "is":
        return {
          [this.path]: value
        };

       case "not":
        return {
          [this.path + "_not"]: value
        };

       case "in":
        return {
          [this.path + "_in"]: value.split(",").map(value => value.trim())
        };

       case "not_in":
        return {
          [this.path + "_not_in"]: value.split(",").map(value => value.trim())
        };
      }
    }), _defineProperty__default.default(this, "getFilterLabel", ({label: label, type: type}) => {
      let suffix = "";
      return [ "in", "not_in" ].includes(type) && (suffix = " (comma separated)"), `${this.label} ${label.toLowerCase()}${suffix}`;
    }), _defineProperty__default.default(this, "formatFilter", ({label: label, type: type, value: value}) => {
      let renderedValue = value;
      return [ "in", "not_in" ].includes(type) && (renderedValue = value.split(",").map(value => value.trim()).join(", ")), 
      `${this.label} ${label.toLowerCase()}: ${renderedValue}`;
    }), _defineProperty__default.default(this, "getFilterTypes", () => [ {
      type: "is",
      label: "Is exactly",
      getInitialValue: () => ""
    }, {
      type: "not",
      label: "Is not",
      getInitialValue: () => ""
    }, {
      type: "in",
      label: "Is one of",
      getInitialValue: () => ""
    }, {
      type: "not_in",
      label: "Is not one of",
      getInitialValue: () => ""
    } ]);
  }
}

exports.default = MongoIdController;
